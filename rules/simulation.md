# Simulation Rules

## 1. 仮説ルール

### 必須事項
- [ ] すべてのシミュレーションは明文化された仮説から始める
- [ ] 仮説は `experiments/expXXX/hypothesis.md` に記載
- [ ] 仮説は「〇〇すれば、△△になる」の形式で記述

### 禁止事項
- 仮説なしのシミュレーション実行
- 結果を見てから仮説を後付け

---

## 2. パラメータルール

### 必須事項
- [ ] すべてのパラメータに根拠（出典）を記載
- [ ] 不確実性が高いパラメータは範囲を明示
- [ ] パラメータは `data/raw/` に JSON 形式で保存

### 根拠の優先順位
1. 学術研究（査読付き論文）
2. 業界調査（Shopify、Statista等）
3. 社内実績データ
4. 類似事例からの推定
5. 専門家の判断（明示必須）

### パラメータ形式
```json
{
  "parameter_name": {
    "value": 0.58,
    "source": "Shopify調査 2026",
    "range": [0.4, 0.7],
    "uncertainty": "medium"
  }
}
```

---

## 3. 再現性ルール

### 必須事項
- [ ] 乱数シードを設定（デフォルト: 42）
- [ ] シード値を結果ファイルに記録
- [ ] 同じシードで同じ結果が得られることを確認

### コード例
```python
import numpy as np

SEED = 42
np.random.seed(SEED)

# シミュレーション実行
result = simulate(...)

# 結果にシードを記録
result.metadata['seed'] = SEED
```

---

## 4. データ保護ルール

### 絶対ルール
- **data/raw/ 配下のファイルは絶対に編集しない**
- パラメータ変更が必要な場合は、新しいファイルを作成

### ディレクトリ構成
```
data/
├── raw/                 # 編集禁止
│   ├── behavior_params.json
│   └── product_tiers.json
└── processed/           # 加工データはここに
    └── experiment_data.csv
```

---

## 5. 実験管理ルール

### 命名規則
```
experiments/
├── exp001_baseline/           # 連番 + 説明
├── exp002_threshold_20k/
└── exp003_sensitivity/
```

### 実験ディレクトリ構成
```
exp001_baseline/
├── hypothesis.md        # 仮説
├── config.json          # 実行時設定
├── main.py              # 実行スクリプト
├── outputs/
│   ├── result.csv       # 結果データ
│   └── figures/         # 図表
└── log.md               # 実験ログ
```

---

## 6. 出力ルール

### 数値の丸め
- 金額: 円単位、千円未満四捨五入
- 率: 小数点以下1桁（%表示）
- 件数: 整数

### 図表の形式
- 解像度: 150 DPI 以上
- フォント: 日本語対応（japanize-matplotlib）
- 色: カラーバリアフリー配慮

### レポートの構成
1. エグゼクティブサマリー（結論先出し）
2. 仮説
3. 手法
4. 結果
5. 感度分析
6. 示唆・提言
7. 付録（詳細データ）

---

## 7. レビュールール

### セルフレビュー項目
- [ ] 仮説と結果の整合性
- [ ] パラメータ根拠の妥当性
- [ ] 結果の解釈に飛躍がないか
- [ ] 感度分析で結論が覆らないか

### 第三者レビュー推奨
- 重要な意思決定に使う場合
- 新しいモデルを導入する場合

---

*これらのルールは CLAUDE.md から参照される*
